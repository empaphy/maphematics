<?php

/**
 * Matrix Tests.
 *
 * @author    Alwin Garside <alwin@garsi.de>
 * @copyright 2025 The Empaphy Project
 * @license   MIT
 *
 * @noinspection NonAsciiCharacters
 * @noinspection PhpIdempotentOperationInspection
 * @noinspection StaticClosureCanBeUsedInspection
 */

declare(strict_types=1);

use empaphy\maphematics\LinearAlgebra\Matrix;

describe('det()', function () {
    test('calculates the determinant', function (array $A, float $expected) {
        $det = Matrix\det($A);
        expect($det)->toBeBetween($expected - Matrix\ε, $expected + Matrix\ε);
    })->with([
        [
            [[1]], 1
        ],
        [
            [
                [0]
            ],
            0
        ],
        [
            [
                [1]
            ],
            1
        ],
        [
            [
                [2]
            ],
            2
        ],
        [
            [
                [5]
            ],
            5
        ],
        [
            [
                [-5]
            ],
            -5
        ],
        [
            [
                [0, 0],
                [0, 0],
            ], 0
        ],
        [
            [
                [0, 0],
                [0, 1],
            ], 0
        ],
        [
            [
                [0, 0],
                [1, 0],
            ], 0
        ],
        [
            [
                [0, 0],
                [1, 1],
            ], 0
        ],
        [
            [
                [0, 1],
                [0, 0],
            ], 0
        ],
        [
            [
                [0, 1],
                [0, 1],
            ], 0
        ],
        [
            [
                [1, 0],
                [0, 0],
            ], 0
        ],
        [
            [
                [1, 0],
                [1, 0],
            ], 0
        ],
        [
            [
                [1, 1],
                [0, 0],
            ], 0
        ],
        [
            [
                [1, 1],
                [1, 1],
            ], 0
        ],
        [
            [
                [0, 1],
                [1, 0],
            ], -1
        ],
        [
            [
                [0, 1],
                [1, 1],
            ], -1
        ],
        [
            [
                [1, 0],
                [0, 1],
            ], 1
        ],
        [
            [
                [1, 0],
                [1, 1],
            ], 1
        ],
        [
            [
                [1, 1],
                [0, 1],
            ], 1
        ],
        [
            [
                [1, 1],
                [1, 0],
            ], -1
        ],
        [
            [
                [3, 8],
                [4, 6],
            ], -14
        ],
        [
            [
                [4, 3],
                [3, 2],
            ], -1
        ],
        [
            [
                [1, 2],
                [3, 4],
            ], -2
        ],
        [
            [
                [1, 2],
                [3, 4],
            ], -2
        ],
        [
            [
                [1, 2],
                [2, 1],
            ], -3
        ],
        [
            [
                [1, 3],
                [3, 1],
            ], -8
        ],
        [
            [
                [6, 1, 1],
                [4, -2, 5],
                [2, 8, 7],
            ], -306
        ],
        [
            [
                [1, 2, 0],
                [-1, 1, 1],
                [1, 2, 3],
            ], 9
        ],
        [
            [
                [1, 2, 3],
                [2, 3, 4],
                [3, 4, 5],
            ], 0
        ],
        [
            [
                [1, 2, 1],
                [-2, -3, 1],
                [3, 5, 0],
            ], 0
        ],
        [
            [
                [1, -1, 2],
                [2, 1, 1],
                [1, 1, 0],
            ], 0
        ],
        [
            [
                [1, 0, 1],
                [0, 1, -1],
                [0, 0, 0],
            ], 0
        ],
        [
            [
                [1, 1, 4, 1, 2],
                [0, 1, 2, 1, 1],
                [0, 0, 0, 1, 2],
                [1, -1, 0, 0, 2],
                [2, 1, 6, 0, 1],
            ], 0
        ],
        [
            [
                [4, 6, 3, 2],
                [3, 6, 5, 3],
                [5, 7, 8, 6],
                [5, 4, 3, 2],
            ], -43
        ],
        [
            [
                [3, 2, 0, 1],
                [4, 0, 1, 2],
                [3, 0, 2, 1],
                [9, 2, 3, 1],
            ], 24
        ],
        [
            [
                [1, 2, 3, 4],
                [5, 6, 7, 8],
                [2, 6, 4, 8],
                [3, 1, 1, 2],
            ], 72
        ],
        [
            [
                [7, 4, 2, 0],
                [6, 3, -1, 2],
                [4, 6, 2, 5],
                [8, 2, -7, 1],
            ], -279
        ],
        [
            [
                [-4, 3, 1, 5, -8],
                [6, 0, 9, 2, 6],
                [-1, 4, 4, 0, 2],
                [8, -1, 3, 4, 0],
                [5, 9, -7, -7, 1]
            ],
            -5763
        ],
        [
            [
                [4, 3, 1, 5, -8],
                [6, 0, 9, 2, 6],
                [-1, 4, 4, 0, 2],
                [8, -1, 3, 4, 0],
                [5, 9, -7, -7, 1]
            ],
            -10035
        ],
        [
            [
                [4, 3, 1, 5, 8],
                [6, 0, 9, 2, 6],
                [-1, 4, 4, 0, 2],
                [8, -1, 3, 4, 0],
                [5, 9, -7, -7, 1]
            ],
            32157
        ],
        [
            [
                [4, 3, 1, 5, 8],
                [6, 0, 9, 2, 6],
                [1, 4, 4, 0, 2],
                [8, -1, 3, 4, 0],
                [5, 9, -7, -7, 1]
            ],
            28287
        ],
        [
            [
                [4, 3, 1, 5, 8],
                [6, 0, 9, 2, 6],
                [1, 4, 4, 0, 2],
                [8, 1, 3, 4, 0],
                [5, 9, -7, -7, 1]
            ],
            30357
        ],
        [
            [
                [4, 3, 1, 5, 8],
                [6, 0, 9, 2, 6],
                [1, 4, 4, 0, 2],
                [8, 1, 3, 4, 0],
                [5, 9, 7, -7, 1]
            ],
            17953
        ],
        [
            [
                [4, 3, 1, 5, 8],
                [6, 0, 9, 2, 6],
                [1, 4, 4, 0, 2],
                [8, 1, 3, 4, 0],
                [5, 9, 7, 7, 1]
            ],
            -11615
        ],
        [
            [
                [5, 2, 0, 0, -2],
                [0, 1, 4, 3, 2],
                [0, 0, 2, 6, 3],
                [0, 0, 3, 4, 1],
                [0, 0, 0, 0, 2],
            ],
            -100
        ],
        [
            [
                [5, 2, 0, 0, 2],
                [0, 1, 4, 3, 2],
                [0, 0, 2, 6, 3],
                [0, 0, 3, 4, 1],
                [0, 0, 0, 0, 2],
            ],
            -100
        ],
        [
            [
                [5, 2, 0, 0, -2],
                [0, -1, 4, 3, 2],
                [0, 0, 2, 6, 3],
                [0, 0, 3, 4, 1],
                [0, 0, 0, 0, 2],
            ],
            100
        ],
        [
            [
                [2, -9, 1, 8, 4],
                [-10, -1, 2, 7, 0],
                [0, 4, -6, 1, -8],
                [6, -14, 11, 0, 3],
                [5, 1, -3, 2, -1],
            ],
            30143
        ],
        [
            [
                [2, 9, 1, 8, 4],
                [-10, -1, 2, 7, 0],
                [0, 4, -6, 1, -8],
                [6, -14, 11, 0, 3],
                [5, 1, -3, 2, -1],
            ],
            -55105
        ],
        [
            [
                [2, 9, 1, 8, 4],
                [10, -1, 2, 7, 0],
                [0, 4, -6, 1, -8],
                [6, -14, 11, 0, 3],
                [5, 1, -3, 2, -1],
            ],
            -5
        ],
        [
            [
                [2, 9, 1, 8, 4],
                [10, 1, 2, 7, 0],
                [0, 4, -6, 1, -8],
                [6, -14, 11, 0, 3],
                [5, 1, -3, 2, -1],
            ],
            6929
        ],
        [
            [
                [276,1,179,23, 9387],
                [0, 0, 78, 0, 0],
                [0, 0, -1, 0, 1],
                [0, 0, 1994, -1, 1089],
                [1, 0, 212, 726, -378],
            ],
            78
        ],
        [
            [
                [276,1,179,23, 9387],
                [0, 0, 78, 0, 0],
                [0, 0, 1, 0, 1],
                [0, 0, 1994, -1, 1089],
                [1, 0, 212, 726, -378],
            ],
            78
        ],
        [
            [
                [276,1,179,23, 9387],
                [0, 0, 78, 0, 0],
                [0, 0, 1, 0, 1],
                [0, 0, 1994, 1, 1089],
                [1, 0, 212, 726, -378],
            ],
            -78
        ],
        [
            [
                [276,1,179,23, 9387],
                [0, 0, 78, 0, 0],
                [0, 0, 1, 0, 1],
                [0, 0, 1994, 1, 1089],
                [1, 0, 212, 726, 378],
            ],
            -78
        ],
        [
            [
                [276,1,179,23, -9387],
                [0, 0, 78, 0, 0],
                [0, 0, 1, 0, 1],
                [0, 0, 1994, 1, 1089],
                [1, 0, 212, 726, 378],
            ],
            -78
        ],
        [
            [
                [1, 2, 3, 4, 5],
                [2, 3, 4, 5, 6],
                [5, 4, 3, 2, 1],
                [4, 3, 2, 1, 0],
                [1, 3, 5, 7, 9],
            ],
            0
        ],
        [
            [
                [1, 0, 3, 5, 1],
                [0, 1, 5, 1, 0],
                [0, 4, 0, 0, 2],
                [2, 3, 1, 2, 0],
                [1, 0, 0, 1, 1],
            ],
            230
        ],
        [
            [
                [2, 3, 4, 1, 3],
                [6, 1, 3, 1, 2],
                [6, 3, 1, 2, 5],
                [4, 2, 4, 7, 8],
                [2, 1, 2, 4, 2],
            ],
            -1016
        ],
        [
            [
                [2, 3, -4, 1, 3],
                [6, 1, 3, 1, 2],
                [6, 3, 1, 2, 5],
                [4, 2, 4, 7, 8],
                [2, 1, 2, 4, 2],
            ],
            296
        ],
        [
            [
                [2, 3, -4, 1, 3],
                [6, 1, -3, 1, 2],
                [6, 3, 1, 2, 5],
                [4, 2, 4, 7, 8],
                [2, 1, 2, 4, 2],
            ],
            1280
        ],
        [
            [
                [2, 3, -4, 1, 3],
                [6, 1, -3, 1, 2],
                [6, 3, -1, 2, 5],
                [4, 2, 4, 7, 8],
                [2, 1, 2, 4, 2],
            ],
            808
        ],
        [
            [
                [2, 3, -4, 1, 3],
                [6, 1, -3, 1, 2],
                [6, 3, -1, 2, 5],
                [4, 2, -4, 7, 8],
                [2, 1, 2, 4, 2],
            ],
            1320
        ],
        [
            [
                [2, 3, -4, 1, 3],
                [6, 1, -3, 1, 2],
                [6, 3, -1, 2, 5],
                [4, 2, -4, 7, 8],
                [2, 1, -2, 4, 2],
            ],
            1016
        ],
        [
            [
                [2, 3, -4, -1, 3],
                [6, 1, -3, 1, 2],
                [6, 3, -1, 2, 5],
                [4, 2, -4, 7, 8],
                [2, 1, -2, 4, 2],
            ],
            1176
        ],
        [
            [
                [2, 3, -4, -1, -3],
                [6, 1, -3, -1, 2],
                [6, 3, -1, 2, 5],
                [4, 2, -4, 7, -8],
                [2, 1, -2, 4, 2],
            ],
            -3664
        ],
        [
            [
                [2, 1, 2],
                [1, 1, 1],
                [2, 2, 5],
            ],
            3
        ],
        [
            [
                [1, 0, 2, -1],
                [3, 0, 0, 5],
                [2, 1, 4, -3],
                [1, 0, 5, 0],
            ],
            30
        ],
        [
            [
                [1, 0, 2, 0, 0, 4],
                [18, 1, 5, 0, 0, 9],
                [3, 5, 3, 6, 0, 4],
                [2, 0, 8, 0, 0, 7],
                [7, 0, 4, 0, 6, 0],
                [0, 0, 1, 0, 0, 0]
            ],
            -36
        ],
        [
            [
                [-1, 0, 2, 0, 0, 4],
                [18, 1, 5, 0, 0, 9],
                [3, 5, 3, 6, 0, 4],
                [2, 0, 8, 0, 0, 7],
                [7, 0, 4, 0, 6, 0],
                [0, 0, 1, 0, 0, 0]
            ],
            -540
        ],
        [
            [
                [-1, 0, -2, 0, 0, 4],
                [18, 1, 5, 0, 0, 9],
                [3, 5, 3, 6, 0, 4],
                [2, 0, 8, 0, 0, 7],
                [7, 0, 4, 0, 6, 0],
                [0, 0, 1, 0, 0, 0]
            ],
            -540
        ],
        [
            [
                [-1, 0, -2, 0, 0, -4],
                [18, 1, 5, 0, 0, 9],
                [3, 5, 3, 6, 0, 4],
                [2, 0, 8, 0, 0, 7],
                [7, 0, 4, 0, 6, 0],
                [0, 0, 1, 0, 0, 0]
            ],
            36
        ],
        [
            [
                [1, 1, 1, 1, 1,  1],
                [1, 3, 1, 3, 1,  3],
                [1, 1, 4, 1, 1,  4],
                [1, 3, 1, 7, 1,  3],
                [1, 1, 1, 1, 6,  1],
                [1, 3, 4, 3, 1, 12]
            ],
            720
        ],
        [
            [
                [-1, 1, 1, 1, 1, 1],
                [1, 3, 1, 3, 1,  3],
                [1, 1, 4, 1, 1,  4],
                [1, 3, 1, 7, 1,  3],
                [1, 1, 1, 1, 6,  1],
                [1, 3, 4, 3, 1, 12]
            ],
            -2448
        ],
        [
            [
                [-1, 1, 1, 1, 1, 1],
                [1, 3, 1, 3, 1,  3],
                [1, 1, 4, 1, 1,  4],
                [1, -3, 1, 7, 1, 3],
                [1, 1, 1, 1, 6,  1],
                [1, 3, 4, 3, 1, 12]
            ],
            -6120
        ],
        [
            [
                [1, 0, 0, 0, 0, 0],
                [0, 2, 0, 0, 0, 0],
                [0, 0, 3, 0, 0, 0],
                [0, 0, 0, 4, 0, 0],
                [0, 0, 0, 0, 5, 0],
                [0, 0, 0, 0, 0, 6]
            ],
            720
        ],
        [
            [
                [-1, 0, 0, 0, 0, 0],
                [0, 2, 0, 0, 0, 0],
                [0, 0, 3, 0, 0, 0],
                [0, 0, 0, 4, 0, 0],
                [0, 0, 0, 0, 5, 0],
                [0, 0, 0, 0, 0, 6]
            ],
            -720
        ],
        [
            [
                [-1, 0, 0, 0, 0, 0],
                [0, 2, 0, 0, 0, 0],
                [0, 0, 0, 4, 0, 0],
                [0, 0, 3, 0, 0, 0],
                [0, 0, 0, 0, 5, 0],
                [0, 0, 0, 0, 0, 6]
            ],
            720
        ],
        [
            [
                [1, 0, 0, 0, 0, 0],
                [1, 2, 0, 0, 0, 0],
                [1, 0, 3, 0, 0, 0],
                [1, 2, 0, 4, 0, 0],
                [1, 0, 0, 0, 5, 0],
                [1, 2, 3, 0, 0, 6],
            ],
            720
        ],
        [
            [
                [0, 1, 4, 3, 2, 3, 3, 4, 4],
                [1, 0, 3, 2, 1, 2, 2, 3, 3],
                [4, 3, 0, 1, 2, 3, 3, 4, 4],
                [3, 2, 1, 0, 1, 2, 2, 3, 3],
                [2, 1, 2, 1, 0, 1, 1, 2, 2],
                [3, 2, 3, 2, 1, 0, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 0, 1, 2],
                [4, 3, 4, 3, 2, 3, 1, 0, 2],
                [4, 3, 4, 3, 2, 3, 2, 2, 0],
            ],
            1472
        ],
        [
            [
                [0, 1, 4, 3, 2, 3, 3, 4, 4],
                [-1, 0, 3, 2, 1, 2, 2, 3, 3],
                [4, 3, 0, 1, 2, 3, 3, 4, 4],
                [3, 2, 1, 0, 1, 2, 2, 3, 3],
                [2, 1, 2, 1, 0, 1, 1, 2, 2],
                [3, 2, 3, 2, 1, 0, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 0, 1, 2],
                [4, 3, 4, 3, 2, 3, 1, 0, 2],
                [4, 3, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [2, 1, 4, 3, 2, 3, 3, 4, 4],
                [1, 2, 3, 2, 1, 2, 2, 3, 3],
                [4, 3, 2, 1, 2, 3, 3, 4, 4],
                [3, 2, 1, 2, 1, 2, 2, 3, 3],
                [2, 1, 2, 1, 2, 1, 1, 2, 2],
                [3, 2, 3, 2, 1, 2, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 2, 1, 2],
                [4, 3, 4, 3, 2, 3, 1, 2, 2],
                [4, 3, 4, 3, 2, 3, 2, 2, 2],
            ],
            128
        ],
        [
            [
                [2, -1, 4, 3, 2, 3, 3, 4, 4],
                [1, 2, 3, 2, 1, 2, 2, 3, 3],
                [4, 3, 2, 1, 2, 3, 3, 4, 4],
                [3, 2, 1, 2, 1, 2, 2, 3, 3],
                [2, 1, 2, 1, 2, 1, 1, 2, 2],
                [3, 2, 3, 2, 1, 2, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 2, 1, 2],
                [4, 3, 4, 3, 2, 3, 1, 2, 2],
                [4, 3, 4, 3, 2, 3, 2, 2, 2],
            ],
            256
        ],
        [
            [
                [2, 1, 4, 3, 2, 3, 3, 4, 4],
                [-1, 2, 3, 2, 1, 2, 2, 3, 3],
                [4, 3, 2, 1, 2, 3, 3, 4, 4],
                [3, 2, 1, 2, 1, 2, 2, 3, 3],
                [2, 1, 2, 1, 2, 1, 1, 2, 2],
                [3, 2, 3, 2, 1, 2, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 2, 1, 2],
                [4, 3, 4, 3, 2, 3, 1, 2, 2],
                [4, 3, 4, 3, 2, 3, 2, 2, 2],
            ],
            256
        ],
        [
            [
                [2, -1, 4, 3, 2, 3, 3, 4, 4],
                [-1, 2, 3, 2, 1, 2, 2, 3, 3],
                [4, 3, 2, 1, 2, 3, 3, 4, 4],
                [3, 2, 1, 2, 1, 2, 2, 3, 3],
                [2, 1, 2, 1, 2, 1, 1, 2, 2],
                [3, 2, 3, 2, 1, 2, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 2, 1, 2],
                [4, 3, 4, 3, 2, 3, 1, 2, 2],
                [4, 3, 4, 3, 2, 3, 2, 2, 2],
            ],
            512
        ],
        [
            [
                [2, -1, 4, 3, 2, 3, 3, 4, 4],
                [-1, 2, 3, 2, 1, 2, 2, 3, 3],
                [4, 3, 2, 1, 2, 3, 3, 4, 4],
                [2, 1, 2, 1, 2, 1, 1, 2, 2],
                [3, 2, 1, 2, 1, 2, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 2, 1, 2],
                [4, 3, 4, 3, 2, 3, 1, 2, 2],
                [4, 3, 4, 3, 2, 3, 2, 2, 2],
            ],
            -512
        ],
        [
            [
                [2, -1, 4, 3, 2, 3, 4, 4],
                [-1, 2, 3, 2, 1, 2, 3, 3],
                [4, 3, 2, 1, 2, 3, 4, 4],
                [2, 1, 2, 1, 2, 1, 2, 2],
                [3, 2, 3, 2, 1, 2, 3, 3],
                [3, 2, 3, 2, 1, 2, 1, 2],
                [4, 3, 4, 3, 2, 1, 2, 2],
                [4, 3, 4, 3, 2, 2, 2, 2],
            ],
            -96,
        ],
        [
            [
                [0, 3, 2, 1, 2, 2, 3, 3],
                [3, 0, 1, 2, 3, 3, 4, 4],
                [2, 1, 0, 1, 2, 2, 3, 3],
                [1, 2, 1, 0, 1, 1, 2, 2],
                [2, 3, 2, 1, 0, 2, 3, 3],
                [2, 3, 2, 1, 2, 0, 1, 2],
                [3, 4, 3, 2, 3, 1, 0, 2],
                [3, 4, 3, 2, 3, 2, 2, 0],
            ],
            -640
        ],
        [
            [
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            -736
        ],
        [
            [
                [1, 4, 3, 2, 3, 3, 4, 4],
                [0, 3, 2, 1, 2, 2, 3, 3],
                [2, 1, 0, 1, 2, 2, 3, 3],
                [1, 2, 1, 0, 1, 1, 2, 2],
                [2, 3, 2, 1, 0, 2, 3, 3],
                [2, 3, 2, 1, 2, 0, 1, 2],
                [3, 4, 3, 2, 3, 1, 0, 2],
                [3, 4, 3, 2, 3, 2, 2, 0],
            ],
            96
        ],
        [
            [
                [1, 4, 3, 2, 3, 3, 4, 4],
                [0, 3, 2, 1, 2, 2, 3, 3],
                [3, 0, 1, 2, 3, 3, 4, 4],
                [1, 2, 1, 0, 1, 1, 2, 2],
                [2, 3, 2, 1, 0, 2, 3, 3],
                [2, 3, 2, 1, 2, 0, 1, 2],
                [3, 4, 3, 2, 3, 1, 0, 2],
                [3, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [1, 4, 3, 2, 3, 3, 4, 4],
                [0, 3, 2, 1, 2, 2, 3, 3],
                [3, 0, 1, 2, 3, 3, 4, 4],
                [2, 1, 0, 1, 2, 2, 3, 3],
                [2, 3, 2, 1, 0, 2, 3, 3],
                [2, 3, 2, 1, 2, 0, 1, 2],
                [3, 4, 3, 2, 3, 1, 0, 2],
                [3, 4, 3, 2, 3, 2, 2, 0],
            ],
            -224
        ],
        [
            [
                [1, 4, 3, 2, 3, 3, 4, 4],
                [0, 3, 2, 1, 2, 2, 3, 3],
                [3, 0, 1, 2, 3, 3, 4, 4],
                [2, 1, 0, 1, 2, 2, 3, 3],
                [1, 2, 1, 0, 1, 1, 2, 2],
                [2, 3, 2, 1, 2, 0, 1, 2],
                [3, 4, 3, 2, 3, 1, 0, 2],
                [3, 4, 3, 2, 3, 2, 2, 0],
            ],
            -96
        ],
        [
            [
                [1, 4, 3, 2, 3, 3, 4, 4],
                [0, 3, 2, 1, 2, 2, 3, 3],
                [3, 0, 1, 2, 3, 3, 4, 4],
                [2, 1, 0, 1, 2, 2, 3, 3],
                [1, 2, 1, 0, 1, 1, 2, 2],
                [2, 3, 2, 1, 0, 2, 3, 3],
                [3, 4, 3, 2, 3, 1, 0, 2],
                [3, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [1, 4, 3, 2, 3, 3, 4, 4],
                [0, 3, 2, 1, 2, 2, 3, 3],
                [3, 0, 1, 2, 3, 3, 4, 4],
                [2, 1, 0, 1, 2, 2, 3, 3],
                [1, 2, 1, 0, 1, 1, 2, 2],
                [2, 3, 2, 1, 0, 2, 3, 3],
                [2, 3, 2, 1, 2, 0, 1, 2],
                [3, 4, 3, 2, 3, 2, 2, 0],
            ],
            -64
        ],
        [
            [
                [1, 4, 3, 2, 3, 3, 4, 4],
                [0, 3, 2, 1, 2, 2, 3, 3],
                [3, 0, 1, 2, 3, 3, 4, 4],
                [2, 1, 0, 1, 2, 2, 3, 3],
                [1, 2, 1, 0, 1, 1, 2, 2],
                [2, 3, 2, 1, 0, 2, 3, 3],
                [2, 3, 2, 1, 2, 0, 1, 2],
                [3, 4, 3, 2, 3, 1, 0, 2],
            ],
            64
        ],
        [
            [
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            -736
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            -1472
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [1, 3, 2, 1, 2, 2, 3, 3],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            -736
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [4, 4, 3, 2, 3, 1, 0, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 4, 3, 2, 3, 3, 4, 4],
                [1, 3, 2, 1, 2, 2, 3, 3],
                [4, 0, 1, 2, 3, 3, 4, 4],
                [3, 1, 0, 1, 2, 2, 3, 3],
                [2, 2, 1, 0, 1, 1, 2, 2],
                [3, 3, 2, 1, 0, 2, 3, 3],
                [3, 3, 2, 1, 2, 0, 1, 2],
                [4, 4, 3, 2, 3, 1, 0, 2],
            ],
            0
        ],
        [
            [
                [1, 0, 2, 1, 2, 2, 3, 3],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 1, 0, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            96
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 1, 0, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [1, 0, 2, 1, 2, 2, 3, 3],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 1, 0, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            -640
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [1, 0, 2, 1, 2, 2, 3, 3],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 1, 0, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            -736
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [1, 0, 2, 1, 2, 2, 3, 3],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 1, 0, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            -224
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [1, 0, 2, 1, 2, 2, 3, 3],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 1, 0, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            -96
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [1, 0, 2, 1, 2, 2, 3, 3],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [4, 3, 3, 2, 3, 1, 0, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [1, 0, 2, 1, 2, 2, 3, 3],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 2, 2, 0],
            ],
            -64
        ],
        [
            [
                [0, 1, 3, 2, 3, 3, 4, 4],
                [1, 0, 2, 1, 2, 2, 3, 3],
                [4, 3, 1, 2, 3, 3, 4, 4],
                [3, 2, 0, 1, 2, 2, 3, 3],
                [2, 1, 1, 0, 1, 1, 2, 2],
                [3, 2, 2, 1, 0, 2, 3, 3],
                [3, 2, 2, 1, 2, 0, 1, 2],
                [4, 3, 3, 2, 3, 1, 0, 2],
            ],
            64
        ],
        [
            [
                [1, 0, 3, 1, 2, 2, 3, 3],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 1, 0, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 1, 0, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [1, 0, 3, 1, 2, 2, 3, 3],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 1, 0, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            -736
        ],
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [1, 0, 3, 1, 2, 2, 3, 3],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 1, 0, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            -1472
        ],
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [1, 0, 3, 1, 2, 2, 3, 3],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 1, 0, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            -736
        ],
        // If zero-values are not handled properly the pivots will be incorrect in this example
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [1, 0, 3, 1, 2, 2, 3, 3],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 1, 0, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [1, 0, 3, 1, 2, 2, 3, 3],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [4, 3, 4, 2, 3, 1, 0, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [1, 0, 3, 1, 2, 2, 3, 3],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 2, 2, 0],
            ],
            0
        ],
        [
            [
                [0, 1, 4, 2, 3, 3, 4, 4],
                [1, 0, 3, 1, 2, 2, 3, 3],
                [4, 3, 0, 2, 3, 3, 4, 4],
                [3, 2, 1, 1, 2, 2, 3, 3],
                [2, 1, 2, 0, 1, 1, 2, 2],
                [3, 2, 3, 1, 0, 2, 3, 3],
                [3, 2, 3, 1, 2, 0, 1, 2],
                [4, 3, 4, 2, 3, 1, 0, 2],
            ],
            0
        ],
        [
            [
                [1, 0, 3, 2, 2, 2, 3, 3],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 1, 0, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            -224
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 1, 0, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            -736
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [1, 0, 3, 2, 2, 2, 3, 3],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 1, 0, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            -224
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [1, 0, 3, 2, 2, 2, 3, 3],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 1, 0, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            -736
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [1, 0, 3, 2, 2, 2, 3, 3],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 1, 0, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            -2544
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [1, 0, 3, 2, 2, 2, 3, 3],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 1, 0, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            -512
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [1, 0, 3, 2, 2, 2, 3, 3],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [4, 3, 4, 3, 3, 1, 0, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            736
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [1, 0, 3, 2, 2, 2, 3, 3],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 2, 2, 0],
            ],
            272
        ],
        [
            [
                [0, 1, 4, 3, 3, 3, 4, 4],
                [1, 0, 3, 2, 2, 2, 3, 3],
                [4, 3, 0, 1, 3, 3, 4, 4],
                [3, 2, 1, 0, 2, 2, 3, 3],
                [2, 1, 2, 1, 1, 1, 2, 2],
                [3, 2, 3, 2, 0, 2, 3, 3],
                [3, 2, 3, 2, 2, 0, 1, 2],
                [4, 3, 4, 3, 3, 1, 0, 2],
            ],
            96
        ],
    ]);
});

describe('multiply()', function () {
    test('multiplies', function (array $expected, array $A, array $B) {
        $R = Matrix\multiply($A, $B);
        expect($R)->toBe($expected);
    })->with([
        '2×2 ⋅ 2×2' => [
            'expected' => [
                [ 2 , 0 ],
                [ 1 ,-2 ],
            ],
            'A' => [
                [ 0 , 2 ],
                [ 1 , 0 ],
            ],
            'B' => [
                [ 1 ,-2 ],
                [ 1 , 0 ],
            ],
        ],
        '2×3 ⋅ 3×2' => [
            'expected' => [
                [ 3 , 2340 ],
                [ 0 , 1000 ],
            ],
            'A' => [
                [ 2 , 3 , 4 ],
                [ 1 , 0 , 0 ],
            ],
            'B' => [
                [ 0 , 1000 ],
                [ 1 ,  100 ],
                [ 0 ,   10 ],
            ],
        ],
        '3×2 ⋅ 2×3 matrix' => [
            'expected' => [
                [ -1*1 + -2*2 , -1*3 + -2*4 , -1*5 + -2*6 ],
                [ -3*1 + -4*2 , -3*3 + -4*4 , -3*5 + -4*6 ],
                [ -5*1 + -6*2 , -5*3 + -6*4 , -5*5 + -6*6 ],
            ],
            'A' => [
                [ -1   , -2 ],
                [ -3   , -4 ],
                [ -5   , -6 ],
            ],
            'B' => [
                [      1      ,    3        ,    5        ],
                [           2 ,           4 ,           6 ],
            ],
        ],
        '3×3 ⋅ 3×3' => [
            'expected' => [
                [ (-3.109) * 41.71                  +  11.131  * 37.73                  +  19.149  * -31.79                  ,
                  (-3.109) *        -47.83          +  11.131  *         43.89          +  19.149  *          53.97          ,
                  (-3.109) *                 59.107 +  11.131  *                -67.103 +  19.149  *                  61.101 ],
                [  13.113  * 41.71                  +  23.137  * 37.73                  + (-5.151) * -31.79                  ,
                   13.113  *        -47.83          +  23.137  *         43.89          + (-5.151) *          53.97          ,
                   13.113  *                 59.107 +  23.137  *                -67.103 + (-5.151) *                  61.101 ],
                [  29.127  * 41.71                  + (-7.139) * 37.73                  +  17.157  * -31.79                  ,
                   29.127  *        -47.83          + (-7.139) *         43.89          +  17.157  *          53.97          ,
                   29.127  *                 59.107 + (-7.139) *                -67.103 +  17.157  *                  61.101 ],
            ],
            'A' => [
                [  -3.109  ,                           11.131  ,                           19.149                            ],
                [  13.113  ,                           23.137  ,                           -5.151                            ],
                [  29.127  ,                           -7.139  ,                           17.157                            ],
            ],
            'B' => [
                [            41.71 ,-47.83 , 59.107                                                                          ],
                [                                                37.73 , 43.89 ,-67.103                                      ],
                [                                                                                    -31.79 , 53.97 , 61.101 ],
            ],
        ],
    ]);
});

describe('transpose()', function () {
    test('transposes', function (array $expected, array $matrix) {
        $Aᵀ = Matrix\transpose($matrix);

        expect($Aᵀ)->toBe($expected);
    })->with([
        '3x3 matrix' => [[
            [ 3, 11, 19],
            [ 5, 13, 23],
            [ 7, 17, 27],
        ], [
            [ 3,  5,  7],
            [11, 13, 17],
            [19, 23, 27],
        ]],
        '3x2 matrix' => [[
            [ 3, 11],
            [ 5, 13],
            [ 7, 17],
        ], [
            [ 3,  5,  7],
            [11, 13, 17],
        ]],
        '2x3 matrix' => [[
            [ 3,  5,  7],
            [11, 13, 17],
        ], [
            [ 3, 11],
            [ 5, 13],
            [ 7, 17],
        ]],
        '1x1 matrix' => [[
            [3],
        ], [
            [3],
        ]],
    ]);
});

describe('is_matrix()', function () {
    test('finds whether value is a matrix', function (bool $expected, mixed $value) {
        $isMatrix = Matrix\is_matrix($value);

        if ($expected) {
            expect($isMatrix)->toBeTrue();
        } else {
            expect($isMatrix)->toBeFalse();
        }
    })->with([
        '1x1 matrix' => [true, [
            [3],
        ]],
        '2x2 matrix' => [true, [
            [ 3  ,  5.7 ],
            [11.0, 17.19],
        ]],
        '3x2 matrix' => [true, [
            [ 3,  5,  7],
            [11, 13, 17],
        ]],
        '2x3 matrix' => [true, [
            [ 3,  5],
            [ 7, 11],
            [13, 17],
        ]],
        'empty matrix' => [false, [
            [],
        ]],
        'not square' => [false, [
            [ 3,  5,  7],
            [11, 13    ],
            [17, 19, 23],
        ]],
        'triangular' => [false, [
            [ 3,  5,  7],
            [11, 13    ],
            [17        ],
        ]],
        'with null' => [false, [
            [ 3,  5,  7],
            [11, 13, null],
            [17, 19, 23],
        ]],
        'with string' => [false, [
            [ 3,  5,  7],
            [11, 13, 'foo'],
            [17, 19, 23],
        ]],
        'vector' => [false, [3, 5, 7]],
    ]);
});
